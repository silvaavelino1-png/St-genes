Code Exercice 1
# 1. Pr√©paration du mot de passe
$Secret = "P@ssword2026!" | ConvertTo-SecureString -AsPlainText -Force

# 2. Boucle de cr√©ation de 1 √† 5
1..5 | ForEach-Object {
    $Name = "Stagiaire$_"
    New-LocalUser -Name $Name -Password $Secret -FullName "Compte Test $Name" -Description "TP Avril 2026"
    Write-Host "Utilisateur $Name cr√©√© avec succ√®s." -ForegroundColor Cyan
}

Code Exercice 2
# Promotion Administrateur
Add-LocalGroupMember -Group "Administrateurs" -Member "Stagiaire1"

# Promotion Config R√©seau
Add-LocalGroupMember -Group "Network Configuration Operators" -Member "Stagiaire2"


Code Exercice 3
# Lister les admins
Get-LocalGroupMember -Group "Administrateurs" | Select-Object Name, PrincipalSource

# Supprimer tous les stagiaires d'un coup (Nettoyage de fin de TP)
Get-LocalUser | Where-Object { $_.Name -like "Stagiaire*" } | Remove-LocalUser


Code Exercice 4 Etape 2
# 1. Importation des donn√©es
    $utilisateurs = Import-Csv -Path "$HOME\Desktop\utilisateurs.csv"

# 2. D√©finition d'un mot de passe s√©curis√© par d√©faut
    $password = "Efrei2024!" | ConvertTo-SecureString -AsPlainText -Force

    foreach ($u in $utilisateurs) {
    # G√©n√©ration du login (ex: Julie.Bernard)

    $username = "$($u.Prenom).$($u.Nom)"
    
# 3. Cr√©ation de l'utilisateur
    New-LocalUser -Name $username `
                  -Password $password `
                  -FullName "$($u.Prenom) $($u.Nom)" `
                  -Description "Poste occup√© : $($u.Poste)"
    
# 4. Attribution des droits selon le poste
    if ($u.Poste -eq "Technicien") {
        Add-LocalGroupMember -Group "Administrateurs" -Member $username
        Write-Host "Utilisateur $username cr√©√© en tant qu'ADMIN." -ForegroundColor Yellow
    } else {
        Add-LocalGroupMember -Group "Utilisateurs" -Member $username
        Write-Host "Utilisateur $username cr√©√© en tant que STANDARD." -ForegroundColor Cyan
    }
}

# üåê Partie 4 : Administration Distante (Travail en Bin√¥me)

### **√âtape 1 : Pr√©paration du poste Cible (Utilisateur B)**
# Active WinRM et configure les exceptions du Pare-feu automatiquement
Enable-PSRemoting -Force

#V√©rification 
Get-NetFirewallRule | Where-Object {$_.Name -like "*WINRM*"} | Select-Object DisplayName, Enabled

# √âtape 2 : Identification (Utilisateur B)
Get-NetIPAddress -AddressFamily IPv4 | Select-Object IPAddress

# √âtape 3 : Prise de contr√¥le (Utilisateur A)
# Remplacez IP_CIBLE par l'adresse de votre voisin
Enter-PSSession -ComputerName IP_CIBLE -Credential (Get-Credential)



